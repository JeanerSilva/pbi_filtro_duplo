{"visual":{"name":"filtroConjugado","displayName":"Filtro Conjugado","guid":"filtroConjugado123456","visualClassName":"Visual","version":"1.0.0.0","description":"Filtro simples conjugado: seleção única/múltipla e sincronização entre instâncias.","supportUrl":"planejamento.gov.br","gitHubUrl":""},"author":{"name":"SEPLAN","email":"seplan@planejamento.gov.br"},"apiVersion":"5.11.0","style":"style/visual.less","stringResources":{},"capabilities":{"privileges":[],"dataRoles":[{"name":"category","kind":"Grouping","displayName":"Itens"}],"dataViewMappings":[{"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"window":{"count":50000}}}}}],"objects":{"behavior":{"displayName":"Comportamento","properties":{"selectionMode":{"displayName":"Seleção única","type":{"bool":true}},"forceSelection":{"displayName":"Forçar seleção (modo único)","type":{"bool":true}}}},"formatting":{"displayName":"Formatação","properties":{"fontSize":{"displayName":"Tamanho da fonte","type":{"formatting":{"fontSize":true}}},"itemPadding":{"displayName":"Espaçamento do item (px)","type":{"numeric":true}}}}},"supportsHighlight":false,"suppressDefaultTitle":true},"dependencies":{"externals":{"powerbi-visuals-api":"5.11.0"}},"content":{"js":"var filtroConjugado123456;(()=>{\"use strict\";var e={111:(e,t,i)=>{i.r(t)},473:(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.VisualSettings=void 0;var i=function(){function e(){this.behavior_selectionMode=!0,this.behavior_forceSelection=!0,this.formatting_fontSize=12,this.formatting_itemPadding=4}return e.parse=function(t){var i=t&&t.metadata&&(t.metadata.objects||{}),s=new e;return s.behavior_selectionMode=o(i,\"behavior\",\"selectionMode\",!0),s.behavior_forceSelection=o(i,\"behavior\",\"forceSelection\",!0),s.formatting_fontSize=n(i,\"formatting\",\"fontSize\",12),s.formatting_itemPadding=n(i,\"formatting\",\"itemPadding\",4),s},e}();function s(e,t){return e&&e[t]||{}}function n(e,t,i,n){var o=s(e,t)[i];return\"number\"!=typeof o||isNaN(o)?n:o}function o(e,t,i,n){var o=s(e,t)[i];return\"boolean\"==typeof o?o:n}t.VisualSettings=i},848:(e,t,i)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.Visual=void 0,i(111);var s=i(473),n=function(){function e(e){var t=this;this.settings=new s.VisualSettings,this.items=[],this.suppressNextSelectCallback=!1,this.externalKeys=new Set,this.didInitialForce=!1,this.itemsSignature=\"\",this.maxItemCount=0,this.lastItemCount=0,this.filteredLock=!1,this.root=document.createElement(\"div\"),this.root.className=\"filtro-conjugado\",this.listContainer=document.createElement(\"div\"),this.listContainer.className=\"list-container\",this.list=document.createElement(\"ul\"),this.list.className=\"list\",this.listContainer.appendChild(this.list),this.root.appendChild(this.listContainer),this.host={persistProperties:function(){}},this.selectionManager={select:function(){return Promise.resolve([])},clear:function(){return Promise.resolve()},registerOnSelectCallback:function(){}},e&&(this.host=e.host,this.selectionManager=this.host.createSelectionManager?this.host.createSelectionManager():this.selectionManager,e.element.appendChild(this.root),this.selectionManager.registerOnSelectCallback(function(e){if(t.suppressNextSelectCallback)t.suppressNextSelectCallback=!1;else{var i=e||[];t.applyExternalSelection(i)}}))}return e.prototype.update=function(e){var t,i,n=e.dataViews&&e.dataViews[0];n&&(this.settings=s.VisualSettings.parse(n));var o=null;if(n&&this.hasDataViewCategories(n)&&(o=this.rebuildItemsWithLock(n)).changed){var a=this.items.map(function(e){return e.label}).join(\"|\");a!==this.itemsSignature&&(this.itemsSignature=a,this.didInitialForce=!1)}var l=this.selectionManager,r=\"function\"==typeof l.hasSelection?!!l.hasSelection():this.externalKeys.size>0;if(o){var c=o.count;this.maxItemCount<c&&(this.maxItemCount=c);var h=this.items.some(function(e){return e.selected});c>0&&this.maxItemCount>0&&(c<this.maxItemCount?this.filteredLock=!0:c!==this.maxItemCount||r||h||(this.filteredLock=!1)),this.lastItemCount=c}if(this.settings.behavior_selectionMode&&this.settings.behavior_forceSelection&&this.items.length>0&&!r&&!this.didInitialForce&&(this.filteredLock||this.maxItemCount===this.items.length)){var d=null===(i=(t=this.items[0].selectionId).getKey)||void 0===i?void 0:i.call(t);if(!this.externalKeys.has(d)){for(var u=0,m=this.items;u<m.length;u++)m[u].selected=!1;this.items[0].selected=!0,this.suppressNextSelectCallback=!0,this.selectionManager.select(this.items[0].selectionId,!1)}this.didInitialForce=!0}this.render()},e.prototype.hasDataViewCategories=function(e){var t,i,s,n,o=null===(i=null===(t=null==e?void 0:e.categorical)||void 0===t?void 0:t.categories)||void 0===i?void 0:i[0],a=null!==(n=null===(s=null==o?void 0:o.values)||void 0===s?void 0:s.length)&&void 0!==n?n:0;return!!o&&a>0},e.prototype.rebuildItemsWithLock=function(e){var t,i=this,s=e.categorical,n=null===(t=null==s?void 0:s.categories)||void 0===t?void 0:t[0],o=(null==n?void 0:n.values)||[],a=o.length;if(!n||0===a)return{changed:!1,count:0};if(this.filteredLock&&a>this.lastItemCount)return{changed:!1,count:this.lastItemCount};for(var l=[],r=0;r<a;r++){var c=o[r],h=this.host.createSelectionIdBuilder().withCategory(n,r).createSelectionId();l.push({label:null==c?\"\":String(c),selectionId:h,selected:!1})}var d=l.length!==this.items.length||l.some(function(e,t){var s;return(null===(s=i.items[t])||void 0===s?void 0:s.label)!==e.label});return d&&(this.items=l),{changed:d,count:a}},e.prototype.render=function(){for(var e=this;this.list.firstChild;)this.list.removeChild(this.list.firstChild);if(0===this.items.length){var t=document.createElement(\"div\");return t.className=\"empty\",t.textContent=\"Sem itens\",void this.list.appendChild(t)}for(var i=function(t){var i=document.createElement(\"li\");i.className=\"item\"+(t.selected?\" selected\":\"\"),i.textContent=t.label,i.style.fontSize=\"\".concat(s.settings.formatting_fontSize,\"px\"),i.style.paddingTop=\"\".concat(s.settings.formatting_itemPadding,\"px\"),i.style.paddingBottom=\"\".concat(s.settings.formatting_itemPadding,\"px\"),i.addEventListener(\"mousedown\",function(e){0===e.button&&e.preventDefault()}),i.addEventListener(\"click\",function(i){if(0===i.button){var s=i.ctrlKey||i.metaKey;e.onItemClick(t,s)}}),s.list.appendChild(i)},s=this,n=0,o=this.items;n<o.length;n++)i(o[n])},e.prototype.onItemClick=function(e,t){var i=!this.settings.behavior_selectionMode;if(i)e.selected=!e.selected;else{for(var s=0,n=this.items;s<n.length;s++)n[s].selected=!1;e.selected=!0}if(this.updateListSelectionClasses(),this.filteredLock=!0,this.didInitialForce=!0,this.suppressNextSelectCallback=!0,i){var o=this.items.filter(function(e){return e.selected}).map(function(e){return e.selectionId});o.length>0?this.selectionManager.select(o,!0):this.selectionManager.clear()}else this.selectionManager.select(e.selectionId,!1)},e.prototype.updateListSelectionClasses=function(){for(var e=Array.prototype.slice.call(this.list.children),t=0;t<e.length;t++){var i=e[t];if(i.classList.contains(\"item\")){var s=this.items[t];s&&i.classList.toggle(\"selected\",!!s.selected)}}},e.prototype.applyExternalSelection=function(e){var t,i,s=new Set((e||[]).map(function(e){var t;return null===(t=e.getKey)||void 0===t?void 0:t.call(e)}));if(this.externalKeys=s,0!==this.items.length){var n=!1;if(e&&0!==e.length){for(var o=0,a=this.items;o<a.length;o++){h=a[o];var l=s.has(null===(i=(t=h.selectionId).getKey)||void 0===i?void 0:i.call(t));h.selected!==l&&(h.selected=l,n=!0)}this.items.length<this.maxItemCount&&(this.filteredLock=!0)}else for(var r=0,c=this.items;r<c.length;r++){var h;(h=c[r]).selected&&(h.selected=!1,n=!0)}n&&this.updateListSelectionClasses()}},e.prototype.enumerateObjectInstances=function(e){var t=[];return\"behavior\"===e.objectName&&t.push({objectName:\"behavior\",properties:{selectionMode:this.settings.behavior_selectionMode,forceSelection:this.settings.behavior_forceSelection},selector:{}}),\"formatting\"===e.objectName&&t.push({objectName:\"formatting\",properties:{fontSize:this.settings.formatting_fontSize,itemPadding:this.settings.formatting_itemPadding},selector:{}}),t},e}();t.Visual=n}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var s={};(()=>{var e=s;Object.defineProperty(e,\"__esModule\",{value:!0});var t=i(848),n=window.powerbi,o={name:\"filtroConjugado123456\",displayName:\"Filtro Conjugado\",class:\"Visual\",apiVersion:\"5.11.0\",create:function(e){if(t.Visual)return new t.Visual(e);throw\"Visual instance not found\"},createModalDialog:function(e,t,i){var s=globalThis.dialogRegistry;e in s&&new s[e](t,i)},custom:!0};void 0!==n&&(n.visuals=n.visuals||{},n.visuals.plugins=n.visuals.plugins||{},n.visuals.plugins.filtroConjugado123456=o),e.default=o})(),filtroConjugado123456=s})();","css":".filtro-conjugado {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.filtro-conjugado .list-container {\n  position: absolute;\n  inset: 0;\n  overflow-y: auto;\n  /* rolagem vertical */\n  padding: 6px;\n  user-select: text;\n  /* permite copiar */\n}\n.filtro-conjugado .list {\n  margin: 0;\n  padding: 0;\n  list-style: none;\n}\n.filtro-conjugado .item {\n  display: block;\n  padding: 6px 8px;\n  cursor: pointer;\n  line-height: 1.25;\n  word-break: break-word;\n  /* quebra no fim da largura */\n  white-space: normal;\n  border-radius: 6px;\n}\n.filtro-conjugado .item:hover {\n  background: rgba(0, 0, 0, 0.06);\n}\n.filtro-conjugado .item.selected {\n  background: rgba(0, 0, 0, 0.12);\n  font-weight: 600;\n}\n.filtro-conjugado .empty {\n  opacity: 0.7;\n  font-style: italic;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":""}